!function(e){function o(e){m.html(""),d=[];var o=[],a=new google.maps.LatLngBounds(new google.maps.LatLng(parseFloat(objValues.south_bound),parseFloat(objValues.west_bound)),new google.maps.LatLng(parseFloat(objValues.north_bound),parseFloat(objValues.east_bound)));null===e?c=a.getCenter():(c=e,a=new google.maps.LatLngBounds(c),i=Math.round(14-Math.log(parseInt(document.getElementById("radius-level").value))/Math.LN2)),r=new google.maps.Map(document.getElementById("map-canvas"),{center:c,zoom:i,scrollwheel:!1,scaleControl:!1,draggable:!1,mapTypeId:google.maps.MapTypeId.ROADMAP});var n=new google.maps.Geocoder;n.geocode({latLng:c},function(t,a){if(a==google.maps.GeocoderStatus.OK){var n=u.value?u.value:t[4].formatted_address,s=new google.maps.Marker({map:r,title:n,position:c,icon:objValues.default_marker_url});null!==e&&new google.maps.Circle({strokeColor:"#28A2D9",strokeWeight:1,fillColor:"#28A2D9",map:r,center:c,radius:1e3*parseInt(document.getElementById("radius-level").value)+500}),l(s,n),o.push(s)}}),google.maps.event.addListener(r,"click",function(){this.setOptions(this.get("scrollwheel")?{scrollwheel:!1,scaleControl:!1,draggable:!1}:{scrollwheel:!0,scaleControl:!0,draggable:!0})});var s=(new google.maps.places.PlacesService(r),new google.maps.places.Autocomplete(u),new google.maps.places.SearchBox(u));google.maps.event.addListenerOnce(s,"places_changed",function(){g=s.getPlaces(),t()});var p=google.maps.event.addListener(r,"bounds_changed",function(){var e=r.getBounds();r.getZoom()>19&&(r.setZoom(19),google.maps.event.removeListener(p)),s.setBounds(e)})}function t(){var t=g;if(t.length>0){if(!t[0].geometry)return;t[0].geometry.viewport?r.fitBounds(t[0].geometry.viewport):(r.setCenter(t[0].geometry.location),r.setZoom(17));var a={location:t[0].geometry.location,radius:1e3*parseInt(document.getElementById("radius-level").value),types:[e("input[name=place_type]:checked","#searchPlacesFrm").val()]},l=new google.maps.places.PlacesService(r);l.nearbySearch(a,n),o(t[0].geometry.location)}}function a(o,t){for(var a,a,n=[],s=0;a=n[s];s++)a.setMap(null);a=new google.maps.Marker({map:r,title:o.name,position:o.geometry.location,icon:objValues[e("input[name=place_type]:checked","#searchPlacesFrm").val()]});var c=new google.maps.Geocoder;c.geocode({location:o.geometry.location},function(e,t){t==google.maps.GeocoderStatus.OK&&e[1]?l(a,o.name):l(a,o.name)}),n.push(a),null!==t&&t.extend(o.geometry.location)}function n(o,t,n){if(e("#gs-nearby-results").fadeOut(),e("#gs-nearby-results-cont").html(""),t===google.maps.places.PlacesServiceStatus.OK){searchLocation=g[0].geometry.location;for(var l=0;l<o.length;l++)if(currentResultLocation=o[l].geometry.location,kilometer=s(searchLocation.G,searchLocation.K,currentResultLocation.G,currentResultLocation.K),d.indexOf(o[l].place_id)<0&&parseInt(document.getElementById("radius-level").value)+.5>=kilometer){var r=e("<li></li>");d.push(o[l].place_id),r.addClass("address_list"),r.addClass(e("input[name=place_type]:checked","#searchPlacesFrm").val()),r.append("<p>"+o[l].name+"</p>"),m.append(r),a(o[l],null)}e("#gs-nearby-results-cont").append(m),e("#title").html("Result"+(e("#gs-nearby-list").find("li").length>1?"s":"")+" found: "+e("#gs-nearby-list").find("li").length+" "+e("input[name=place_type]:checked","#searchPlacesFrm").data("place-label")+(e("#gs-nearby-list").find("li").length>1?"s":"")+" around the radius of "+parseInt(document.getElementById("radius-level").value)+" Km"+(document.getElementById("radius-level").value>1?"s":"")),e("#gs-nearby-results-cont").append('<a id="more" href="javascript:void(0);">Get more</a>');var c=document.getElementById("more");n.hasNextPage?(e("#more").show(),c.disabled=!1,google.maps.event.addDomListenerOnce(c,"click",function(){c.disabled=!0,n.nextPage()}),e("#gs-nearby-list").find("li").length<20&&c.click()):e("#more").hide(),e("#gs-nearby-results").fadeIn(),m.outerHeight()<=parseInt(e("#gs-nearby-results-cont").css("max-height"))-50?e("#gs-scroll-down").fadeOut():e("#gs-scroll-down").fadeIn()}else e("#title").text("No result found!..."),e("#gs-nearby-results").fadeIn()}function l(e,o){var t=new google.maps.InfoWindow({content:o,maxWidth:150});google.maps.event.addListener(e,"click",function(){r.setZoom(19),t.open(r,e),r.panTo(e.getPosition())}),google.maps.event.addListener(t,"closeclick",function(){r.panTo(c),r.setZoom(i)})}function s(e,o,t,a){var n=6371,l=(t-e)*(Math.PI/180),s=(a-o)*(Math.PI/180),r=Math.sin(l/2)*Math.sin(l/2)+Math.cos(e*(Math.PI/180))*Math.cos(t*(Math.PI/180))*Math.sin(s/2)*Math.sin(s/2),c=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),i=n*c;return i}var r,c,i=11,g=[],d=[],u=document.getElementById("autocomplete"),m=e("<ul></ul>");m.attr("id","gs-nearby-list"),m.addClass("gs-full-width"),e(window).load(function(){e("#radius-level").chosen(),o(null);/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||e(".scroll").remove()}),document.getElementById("autocomplete").onchange=function(){e(this).removeClass("alert")},document.getElementById("searchbutton").onclick=function(){e("#autocomplete").removeClass("alert");var o=e.trim(u.value);if(""===o)return e("#autocomplete").addClass("alert"),void e("html, body").animate({scrollTop:e("#autocomplete").offset().top-50},500);if(google.maps.event.trigger(u,"focus"),google.maps.event.trigger(u,"keydown",{keyCode:13}),g.length<1){var a=new google.maps.Geocoder;a.geocode({address:'"'+o+'"'},function(e,o){"OK"==o&&(g=e,t())})}}}(jQuery);